VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "Sheet1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Private Sub Worksheet_Change(ByVal Target As Range)
   Dim IsColumnOrRowInsertOrDelete As Byte
   If (Target.Column <= Asc("P") - Asc("A") + 1) Then
      Config
      IsColumnOrRowInsertOrDelete = IsColumOrRowBeingInsertedOrDeleted(Target)
      ' If (IsColumnInsertOrDelete? true : IsEmptyRange(Target))
      ' Un citur vareetu if( a() || b() ) - un b netiktu izpildiits, ja a jau true atgriez...
      ' The answer is yes, VBA does not short circuit evaluation  - cakars ka saadi jaaraksta ar ntajiem if zariem!!!
      If (IsColumnOrRowInsertOrDelete = 0) Then
         'if allowed cell
         If (IsFromTheInputRange(Target)) Then
            If ([vba_setting_AutoFillEmptyDataAreasAtInput]) Then
            
            Call FillEmptyAndTryFixInvalidDataCells(GetInputAreaRangeCorrespondingToThisRange(Target), True)
            End If
            Call ApplyCss(Target)
            If (Target.Column = 1 And Not ((IsColumnOrRowInsertOrDelete And 2) = 2)) Then
               Call ValidateLatvianNames(Target)
            End If
            Call AdjustValidation(Target)
            'if auto-generated-value cell
         Else
            'Forbid changing autogenerated values cells
            Application.EnableEvents = False
            Application.Undo
            Application.EnableEvents = True
         End If
      Else
         'forbid column inserts / deletes here! Inside the area, therefore forbid!
         If ((IsColumnOrRowInsertOrDelete And 2) = 2) Then
            Application.EnableEvents = False
            Application.Undo
            Application.EnableEvents = True
            MsgBoxW ("L" + LV("u") + "dzu nemain" + LV("i") + "t ievada" + vbCr + _
                     "un autom" + LV("a") + "tisk" + LV("a") + "s apr" + LV("e") + LV("k") + "ina kolonas!")
         Else
            'too complicated. In order to differiante between a delete and an insert, have to make reference row, which might be modified/deleted in use scenario!
            'Call RemoveCss(Target)
            'remove auto-copied validations at empty rows (insert. At multirow delete simply do nothing as they are being deleted anyways)!
            Call RemoveValidationAtRowInsert(Target)
         End If
      End If
   End If

End Sub

